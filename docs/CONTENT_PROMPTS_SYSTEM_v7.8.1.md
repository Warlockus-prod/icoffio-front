# 📝 СИСТЕМА УПРАВЛЕНИЯ ПРОМПТАМИ КОНТЕНТА v7.8.1

## 🎯 Решение проблемы

### Проблема:
- Промпты обработки текста захардкожены в коде
- Нет возможности выбрать стиль обработки
- В Telegram боте нет опций для пользователя
- Нельзя отключить обработку ("оставить как есть")

### Решение:
✅ **Система preset шаблонов** с 7 готовыми стилями  
✅ **UI редактор** в админ-панели для управления промптами  
✅ **Telegram кнопки** для выбора стиля обработки  
✅ **Кастомные промпты** - возможность написать свой промпт  
✅ **Тестирование** промптов перед использованием  

---

## 🎨 Доступные стили обработки

### 1. 📰 Публицистический стиль (default)
**Когда использовать**: Для широкой аудитории, новостные статьи  
**Что делает**:
- Увлекательный и захватывающий стиль
- Ясный, лаконичный, легко читаемый
- Активный залог
- Добавляет контекст и примеры

**Пример промпта**:
```
You are a professional journalist. Rewrite the text in a 
journalistic style that is engaging, clear, and well-structured.
Use active voice and compelling language while maintaining
factual accuracy.
```

---

### 2. ✋ Оставить как есть
**Когда использовать**: Готовый текст, словарные статьи, официальные тексты  
**Что делает**:
- **НИЧЕГО НЕ ИЗМЕНЯЕТ**
- Возвращает текст точь-в-точь как есть
- Только форматирование параграфов

**Пример использования**:
```
Входной текст:
"Квантовые компьютеры используют кубиты..."

Выходной текст:
"Квантовые компьютеры используют кубиты..."
(без изменений)
```

---

### 3. 🔍 SEO оптимизация
**Когда использовать**: Для поискового продвижения  
**Что делает**:
- Естественное использование ключевых слов
- Оптимизированные H2/H3 заголовки
- Короткие параграфы для сканируемости
- Meta-friendly контент

---

### 4. 🎓 Академический стиль
**Когда использовать**: Научные статьи, исследования  
**Что делает**:
- Формальный научный язык
- Четкая структура: тезис → аргументы
- Объективность, отсутствие предвзятости
- Критическое мышление

---

### 5. 💬 Разговорный стиль
**Когда использовать**: Блоги, социальные медиа  
**Что делает**:
- Простой повседневный язык
- Обращение к читателю напрямую (ты/вы)
- Дружелюбный тон
- Короткие предложения

---

### 6. ⚙️ Технический стиль
**Когда использовать**: Для специалистов, технические руководства  
**Что делает**:
- Точная терминология
- Детальные спецификации
- Логическая структура
- Предполагает знание домена

---

### 7. ✨ Кастомный промпт
**Когда использовать**: Уникальные требования  
**Что делает**:
- Использует ваш собственный промпт
- Полный контроль над инструкциями
- Гибкость для экспериментов

**Пример**:
```
Кастомный промпт:
"Переписать текст в стиле Хемингуэя: короткие 
предложения, минимум прилагательных, максимум действия"

Результат:
Короткие. Резкие. Предложения. Много действий.
```

---

## 💻 Использование в админ-панели

### Где находится:
```
Admin → Content Prompts
```

### Интерфейс:

```
┌────────────────────────────────────────────────────────┐
│ 📝 Управление промптами контента                       │
├────────────────────────────────────────────────────────┤
│                                                        │
│ 📊 Stats:                                              │
│ [Всего: 7] [Активных: 7] [Default: 📰 Публ.] [...]   │
│                                                        │
│ ┌──────────────┐  ┌──────────────────────────────┐    │
│ │ Preset       │  │ Детали: 📰 Публицистический  │    │
│ │ шаблоны      │  │                               │    │
│ ├──────────────┤  │ Системный промпт:             │    │
│ │              │  │ ┌───────────────────────────┐ │    │
│ │ [📰 Публ.] ✓ │  │ │ You are a professional... │ │    │
│ │ [✋ Как есть]│  │ │ ...                       │ │    │
│ │ [🔍 SEO]     │  │ └───────────────────────────┘ │    │
│ │ [🎓 Академ.] │  │ [📋 Копировать] [✏️ Редакт.] │    │
│ │ [💬 Разгов.] │  │                               │    │
│ │ [⚙️ Техн.]   │  │ Кастомные инструкции:         │    │
│ │ [✨ Кастом]  │  │ [Текстовое поле для ввода...] │    │
│ └──────────────┘  └──────────────────────────────┘    │
│                                                        │
│ 🧪 Тестирование промпта                                │
│ ┌────────────────┐  ┌────────────────┐               │
│ │ Исходный текст │  │ Обработанный   │               │
│ │ [Textarea...]  │  │ [Result...]    │               │
│ └────────────────┘  └────────────────┘               │
│ [🚀 Тестировать промпт]                               │
└────────────────────────────────────────────────────────┘
```

### Как редактировать промпт:

1. Выберите шаблон из списка слева
2. Нажмите **✏️ Редактировать**
3. Измените текст промпта
4. Нажмите **✅ Сохранить**
5. (Опционально) Протестируйте изменения

### Как тестировать промпт:

1. Выберите шаблон
2. Введите текст в "Исходный текст"
3. (Для кастомного) введите свои инструкции
4. Нажмите **🚀 Тестировать промпт**
5. Результат появится справа

---

## 📱 Использование в Telegram боте

### Сценарий 1: Базовый (3 кнопки)

Когда пользователь отправляет текст боту:

```
User: [Отправляет текст]

Bot: 
"Выберите стиль обработки текста:

[📰 Публицистический] [✋ Оставить как есть] [✨ Свой промпт]"
```

**Нажатие кнопок**:

- **📰 Публицистический** → AI переписывает в публицистическом стиле
- **✋ Оставить как есть** → текст не изменяется
- **✨ Свой промпт** → бот просит ввести кастомный промпт:

```
Bot: "Введите ваши инструкции для AI:
Например: 'Переписать в стиле научной статьи'"

User: [Вводит промпт]

Bot: [Обрабатывает текст с кастомным промптом]
```

---

### Сценарий 2: Расширенный (все стили)

Для опытных пользователей можно показать все 7 стилей:

```
Bot:
"Выберите стиль обработки:

Ряд 1: [📰 Публицистический] [✋ Как есть] [🔍 SEO]
Ряд 2: [🎓 Академический] [💬 Разговорный] [⚙️ Технический]
Ряд 3: [✨ Свой промпт]"
```

---

### Пример полного flow в Telegram:

```
1. User: /compose
   Bot: "Режим составления активирован. Отправьте текст."

2. User: "Квантовые компьютеры изменят мир..."
   Bot: "Выберите стиль:
        [📰 Публицистический] [✋ Как есть] [✨ Свой]"

3. User: [Нажимает 📰 Публицистический]
   Bot: "🤖 Обрабатываю текст в публицистическом стиле..."
   
4. Bot: "✅ Текст добавлен!
        Отправьте еще текст или /publish для публикации"

5. User: /publish
   Bot: "Выберите действие:
        [📤 Publish] [🔄 Edit] [❌ Cancel]"
```

---

## 🛠️ Техническая реализация

### Файлы:

```
lib/config/content-prompts.ts
├─ ContentPromptTemplate (интерфейс)
├─ CONTENT_PROMPT_TEMPLATES (7 preset шаблонов)
├─ buildContentPrompt() (построение промпта)
└─ getTelegramStyleButtons() (кнопки для бота)

components/admin/ContentPromptManager.tsx
├─ UI редактор промптов
├─ Список шаблонов
├─ Детали шаблона
└─ Тестирование промптов

app/api/admin/test-content-prompt/route.ts
└─ API для тестирования промптов

app/api/telegram/webhook/route.ts
└─ Обработка callback кнопок выбора стиля
```

---

### API Usage:

**Построение промпта**:
```typescript
import { buildContentPrompt } from '@/lib/config/content-prompts';

const prompt = buildContentPrompt(
  'journalistic', // templateId
  undefined,      // customPrompt (для custom style)
  'Tech article'  // additionalContext
);
```

**Telegram кнопки**:
```typescript
import { getTelegramStyleButtons } from '@/lib/config/content-prompts';

const buttons = getTelegramStyleButtons();
// [
//   { text: '📰 Публицистический', callback_data: 'style:journalistic' },
//   { text: '✋ Оставить как есть', callback_data: 'style:as-is' },
//   { text: '✨ Свой промпт', callback_data: 'style:custom' }
// ]
```

**Тестирование промпта**:
```typescript
const response = await fetch('/api/admin/test-content-prompt', {
  method: 'POST',
  body: JSON.stringify({
    text: 'Исходный текст...',
    systemPrompt: 'You are a journalist...',
    style: 'journalistic'
  })
});

const { processedText } = await response.json();
```

---

## 📊 Сравнение: До vs После

### ❌ Старая система:

```typescript
// Хардкод в коде
const systemPrompt = "You are a journalist. Rewrite...";

// Один вариант для всех
await generateArticle(text, systemPrompt);

// Нет выбора для пользователя
// Нет возможности отключить обработку
```

**Проблемы**:
- Один стиль для всех
- Нельзя оставить текст как есть
- Изменения требуют редактирования кода
- Нет preview/тестирования

---

### ✅ Новая система:

```typescript
// 7 preset шаблонов
const templates = CONTENT_PROMPT_TEMPLATES;

// Выбор стиля
const style = userChoice; // 'journalistic' | 'as-is' | ...

// Построение промпта
const prompt = buildContentPrompt(style, customPrompt);

// Обработка с выбранным стилем
await generateArticle(text, prompt);
```

**Преимущества**:
- ✅ 7 стилей на выбор
- ✅ Опция "оставить как есть"
- ✅ UI редактор без редактирования кода
- ✅ Тестирование промптов
- ✅ Кастомные промпты
- ✅ Telegram кнопки для пользователей

---

## 🎯 Use Cases

### 1. Новостной сайт
**Используйте**: 📰 Публицистический (default)  
**Почему**: Увлекательный стиль для широкой аудитории

### 2. Технический блог
**Используйте**: ⚙️ Технический  
**Почему**: Специализированная терминология для профи

### 3. Словарь/Энциклопедия
**Используйте**: ✋ Оставить как есть  
**Почему**: Точность определений важнее стиля

### 4. SEO контент
**Используйте**: 🔍 SEO оптимизация  
**Почему**: Оптимизация для поисковиков

### 5. Академические статьи
**Используйте**: 🎓 Академический  
**Почему**: Научный стиль с формальным языком

### 6. Блог/Соц. медиа
**Используйте**: 💬 Разговорный  
**Почему**: Дружелюбный и доступный стиль

### 7. Уникальные требования
**Используйте**: ✨ Кастомный  
**Почему**: Полный контроль над обработкой

---

## 🔮 Будущие улучшения (v7.9.0+)

1. **Сохранение в БД**
   - Хранение кастомных промптов
   - История изменений
   - Версионирование промптов

2. **A/B тестирование**
   - Сравнение эффективности стилей
   - Метрики читаемости
   - User engagement stats

3. **Автоматический выбор стиля**
   - AI определяет лучший стиль для контента
   - Рекомендации на основе категории

4. **Batch обработка**
   - Применение стиля к нескольким статьям
   - Массовая переобработка контента

5. **Мультиязычность**
   - Промпты на разных языках
   - Автоматический перевод промптов

---

## ✅ Checklist для использования

- [ ] Изучить 7 стилей обработки
- [ ] Протестировать каждый стиль на примере
- [ ] Настроить Telegram кнопки (базовые или расширенные)
- [ ] Обучить пользователей использованию кнопок
- [ ] (Опционально) Создать кастомные промпты для специфических задач
- [ ] Настроить дефолтный стиль для вашего проекта

---

**v7.8.1** - Content Prompts Management System  
**Автор**: AI Assistant  
**Дата**: 30 октября 2025

