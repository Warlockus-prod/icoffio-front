/**
 * TELEGRAM BOT INTERNATIONALIZATION
 * 
 * Multi-language support for Telegram bot interface
 * Supported languages: Russian, Polish, English
 * 
 * NOTE: Uses in-memory cache + Supabase database for persistence
 */

import { telegramDB } from './telegram-database-service';

export type BotLanguage = 'ru' | 'pl' | 'en';

// In-memory cache for fast access (populated from DB)
// This cache resets on Vercel function cold start, but DB persists
const languageCache = new Map<number, BotLanguage>();

/**
 * Get user's preferred language (cached + DB fallback)
 */
export function getUserLanguage(chatId: number): BotLanguage {
  // Try cache first (fast)
  const cached = languageCache.get(chatId);
  if (cached) {
    return cached;
  }

  // Cache miss - will load from DB on next interaction
  // For now return default
  return 'ru'; // Default: Russian
}

/**
 * Set user's preferred language (cache + DB)
 */
export function setUserLanguage(chatId: number, language: BotLanguage): void {
  languageCache.set(chatId, language);
  // DB update happens separately in webhook/route.ts
}

/**
 * Load user language from database and cache it
 * Called on first message from user
 */
export async function loadUserLanguage(chatId: number): Promise<BotLanguage> {
  try {
    const language = await telegramDB.getUserLanguage(chatId);
    languageCache.set(chatId, language);
    return language;
  } catch (error) {
    console.error('[i18n] Failed to load user language from DB:', error);
    return 'ru'; // Default fallback
  }
}

/**
 * All bot messages in 3 languages
 */
export const translations: Record<BotLanguage, {
  // Commands
  start: string;
  help: string;
  helpDetails: string;
  queue: string;
  status: string;
  language: string;
  languagePrompt: string;
  languageChanged: string;
  unknownCommand: string;

  // Compose mode commands
  compose: string;
  composeStarted: string;
  composeInfo: string;
  publish: string;
  cancel: string;
  composeCancelled: string;
  notInComposeMode: string;
  composeEmpty: string;
  composeStats: string;

  // Delete command
  deleteCommand: string;
  deletePrompt: string;
  deleteSuccess: string;
  deleteError: string;
  invalidArticleUrl: string;

  // Inline buttons
  btnAddMore: string;
  btnPublishNow: string;

  // Processing messages
  textReceived: string;
  urlReceived: string;
  addedToQueue: string;
  aiGenerating: string;
  pleaseWait: string;

  // Success messages
  published: string;
  title: string;
  words: string;
  languages: string;
  time: string;
  statusPublished: string;
  category: string;

  // Error messages
  error: string;
  jobNotFound: string;
  createdNotPublished: string;
  checkSettings: string;
  errorAiGeneration: string;
  errorUrlParsing: string;
  errorPublication: string;
  errorProcessing: string;
  timeout: string;
  checkLater: string;

  // Queue status
  queueStatus: string;
  totalJobs: string;
  pending: string;
  processing: string;
  completed: string;
  errors: string;
  systemWorking: string;
  systemWaiting: string;

  // System status
  systemActive: string;
  aiModel: string;
  images: string;
  languagesSupported: string;
  queueActive: string;
  allSystemsNormal: string;
}> = {
  ru: {
    // Commands
    start: 'üëã <b>–ü—Ä–∏–≤–µ—Ç! –Ø icoffio Bot</b>\n\n' +
           '–Ø –ø–æ–º–æ–≥—É —Ç–µ–±–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç–∞—Ç—å–∏:\n\n' +
           'üìù <b>–û—Ç–ø—Ä–∞–≤—å —Ç–µ–∫—Å—Ç</b> ‚Üí –°–æ–∑–¥–∞–º —Å—Ç–∞—Ç—å—é —Å AI\n' +
           'üîó <b>–û—Ç–ø—Ä–∞–≤—å URL</b> ‚Üí –°–ø–∞—Ä—Å—é –∏ –æ–ø—É–±–ª–∏–∫—É—é\n\n' +
           'üìã <b>–ö–æ–º–∞–Ω–¥—ã:</b>\n' +
           '/help - –ü–æ–º–æ—â—å\n' +
           '/compose - –†–µ–∂–∏–º —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è\n' +
           '/delete - –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é\n' +
           '/queue - –°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏\n' +
           '/status - –ú–æ–π —Å—Ç–∞—Ç—É—Å\n' +
           '/language - –í—ã–±–æ—Ä —è–∑—ã–∫–∞\n\n' +
           'Powered by GPT-4o ü§ñ',
    help: 'üìñ <b>–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞:</b>',
    helpDetails: '<b>1. –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç—å–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞</b>\n' +
                 '–ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å —Ç–µ–∫—Å—Ç (1-2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–ª–∏ –ø–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç).\n' +
                 'AI —Å–æ–∑–¥–∞—Å—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Å—Ç–∞—Ç—å—é.\n\n' +
                 '<b>2. –†–µ–∂–∏–º —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è (–¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–µ–π)</b>\n' +
                 '/compose - –ù–∞—á–∞—Ç—å —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ\n' +
                 '–û—Ç–ø—Ä–∞–≤–ª—è–π –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥\n' +
                 '/publish - –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤—Å–µ –≤–º–µ—Å—Ç–µ\n' +
                 '/cancel - –û—Ç–º–µ–Ω–∏—Ç—å —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ\n\n' +
                 '<b>3. –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç–∞—Ç—å–∏ —Å URL</b>\n' +
                 '–û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ç—å—é.\n' +
                 '–ë–æ—Ç —Å–ø–∞—Ä—Å–∏—Ç –∏ –¥–æ–±–∞–≤–∏—Ç –≤ —Å–∏—Å—Ç–µ–º—É.\n\n' +
                 '<b>4. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</b>\n' +
                 '/delete - –û—Ç–ø—Ä–∞–≤—å —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ç—å—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è\n\n' +
                 '<b>–ö–æ–º–∞–Ω–¥—ã:</b>\n' +
                 '/start - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã\n' +
                 '/compose - –†–µ–∂–∏–º —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è\n' +
                 '/publish - –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–µ\n' +
                 '/cancel - –û—Ç–º–µ–Ω–∏—Ç—å\n' +
                 '/delete - –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ç—å—é\n' +
                 '/queue - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—á–µ—Ä–µ–¥—å\n' +
                 '/status - –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã\n' +
                 '/language - –í—ã–±–æ—Ä —è–∑—ã–∫–∞',
    queue: 'üìä <b>–°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏:</b>',
    status: '‚úÖ <b>–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞</b>',
    language: 'üåç <b>–í—ã–±–æ—Ä —è–∑—ã–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</b>',
    languagePrompt: '–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:\n' +
                    'üá∑üá∫ –†—É—Å—Å–∫–∏–π - /lang_ru\n' +
                    'üáµüá± Polski - /lang_pl\n' +
                    'üá¨üáß English - /lang_en',
    languageChanged: '‚úÖ –Ø–∑—ã–∫ –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ –†—É—Å—Å–∫–∏–π',
    unknownCommand: '‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞',

    // Compose mode
    compose: 'üìù <b>–†–µ–∂–∏–º —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω</b>',
    composeStarted: '‚úçÔ∏è –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–π —Å–æ–æ–±—â–µ–Ω–∏—è –æ–¥–Ω–æ –∑–∞ –¥—Ä—É–≥–∏–º.\n' +
                    '–Ø –æ–±—ä–µ–¥–∏–Ω—é –∏—Ö –≤ –æ–¥–Ω—É —Å—Ç–∞—Ç—å—é.\n\n' +
                    'üìã <b>–ö–æ–º–∞–Ω–¥—ã:</b>\n' +
                    '/publish - –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –≤—Å–µ\n' +
                    '/cancel - –û—Ç–º–µ–Ω–∏—Ç—å',
    composeInfo: 'üìä <b>–ù–∞–∫–æ–ø–ª–µ–Ω–æ:</b>',
    publish: '‚úÖ <b>–ü—É–±–ª–∏–∫—É—é —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—É—é —Å—Ç–∞—Ç—å—é...</b>',
    cancel: '‚ùå <b>–û—Ç–º–µ–Ω–µ–Ω–æ</b>',
    composeCancelled: '–†–µ–∂–∏–º —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –æ—Ç–º–µ–Ω–µ–Ω. –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω—ã.',
    notInComposeMode: '‚ö†Ô∏è –í—ã –Ω–µ –≤ —Ä–µ–∂–∏–º–µ —Å–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è.\n\n–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /compose —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å.',
    composeEmpty: '‚ö†Ô∏è –ù–µ—Ç –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.\n\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã /compose',
    composeStats: '–°–æ–æ–±—â–µ–Ω–∏–π: {count}\n–°–∏–º–≤–æ–ª–æ–≤: {length}\n–í—Ä–µ–º—è: {duration} —Å–µ–∫',

    // Delete command
    deleteCommand: 'üóëÔ∏è <b>–£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—å–∏</b>',
    deletePrompt: '–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ç—å—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è:\n\n' +
                  '–ù–∞–ø—Ä–∏–º–µ—Ä:\n' +
                  'https://app.icoffio.com/en/article/my-article-en\n' +
                  'https://app.icoffio.com/pl/article/my-article-pl',
    deleteSuccess: '‚úÖ <b>–°—Ç–∞—Ç—å—è —É–¥–∞–ª–µ–Ω–∞!</b>\n\n' +
                   'üìù Slug: {slug}\n' +
                   'üåç –Ø–∑—ã–∫: {lang}',
    deleteError: '‚ùå <b>–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è</b>\n\n{error}',
    invalidArticleUrl: '‚ùå <b>–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Å—ã–ª–∫–∞</b>\n\n' +
                       '–°—Å—ã–ª–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ:\n' +
                       'https://app.icoffio.com/[—è–∑—ã–∫]/article/[slug]',

    // Inline buttons
    btnAddMore: 'üìù –î–æ–±–∞–≤–∏—Ç—å –µ—â–µ',
    btnPublishNow: '‚úÖ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–µ–π—á–∞—Å',

    // Processing
    textReceived: '‚ú® <b>–¢–µ–∫—Å—Ç –ø–æ–ª—É—á–µ–Ω!</b>',
    urlReceived: 'üîÑ <b>URL –ø–æ–ª—É—á–µ–Ω!</b>',
    addedToQueue: 'üìã –î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –æ—á–µ—Ä–µ–¥—å:',
    aiGenerating: 'ü§ñ AI –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç—å—é...',
    pleaseWait: '‚è≥ –û–∂–∏–¥–∞–π—Ç–µ (~60 —Å–µ–∫—É–Ω–¥)',

    // Success
    published: '‚úÖ <b>–û–ü–£–ë–õ–ò–ö–û–í–ê–ù–û!</b>',
    title: 'üìù <b>–ó–∞–≥–æ–ª–æ–≤–æ–∫:</b>',
    words: 'üí¨ <b>–°–ª–æ–≤:</b>',
    languages: 'üåç <b>–Ø–∑—ã–∫–∏:</b>',
    time: '‚è±Ô∏è <b>–í—Ä–µ–º—è:</b>',
    statusPublished: '‚ú® <b>–°—Ç–∞—Ç—É—Å:</b> –û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ –Ω–∞ —Å–∞–π—Ç–µ!',
    category: 'üìÅ <b>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</b>',

    // Errors
    error: '‚ùå <b>–û—à–∏–±–∫–∞</b>',
    jobNotFound: '–ó–∞–¥–∞–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.',
    createdNotPublished: '‚úÖ <b>–°–æ–∑–¥–∞–Ω–æ (–Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ)</b>',
    checkSettings: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WordPress.',
    errorAiGeneration: '‚ùå <b>–û—à–∏–±–∫–∞ AI –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏</b>\n\n–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç —Å—Ç–∞—Ç—å–∏.',
    errorUrlParsing: '‚ùå <b>–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ URL</b>\n\n–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ —Å—Å—ã–ª–∫–µ.',
    errorPublication: '‚ùå <b>–û—à–∏–±–∫–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏</b>\n\n–°—Ç–∞—Ç—å—è —Å–æ–∑–¥–∞–Ω–∞, –Ω–æ –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞.',
    errorProcessing: '‚ùå <b>–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏</b>',
    timeout: '‚è±Ô∏è <b>Timeout</b>\n\n–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–Ω–∏–º–∞–µ—Ç —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.',
    checkLater: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –ø–æ–∑–∂–µ –∫–æ–º–∞–Ω–¥–æ–π /queue',

    // Queue status
    queueStatus: 'üìä <b>–°—Ç–∞—Ç—É—Å –æ—á–µ—Ä–µ–¥–∏:</b>',
    totalJobs: 'üìã –í—Å–µ–≥–æ –∑–∞–¥–∞–Ω–∏–π:',
    pending: '‚è≥ –í –æ–∂–∏–¥–∞–Ω–∏–∏:',
    processing: '‚öôÔ∏è –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è:',
    completed: '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ:',
    errors: '‚ùå –û—à–∏–±–∫–∏:',
    systemWorking: 'üîÑ –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç',
    systemWaiting: 'üí§ –°–∏—Å—Ç–µ–º–∞ –æ–∂–∏–¥–∞–µ—Ç',

    // System status
    systemActive: '‚úÖ <b>–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–Ω–∞</b>',
    aiModel: 'ü§ñ AI: GPT-4o',
    images: 'üé® –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: DALL-E 3 + Unsplash',
    languagesSupported: 'üåç –Ø–∑—ã–∫–∏: RU, EN, PL',
    queueActive: 'üìä Queue: –ê–∫—Ç–∏–≤–Ω–∞',
    allSystemsNormal: '–í—Å–µ —Å–∏—Å—Ç–µ–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ!'
  },
  
  pl: {
    // Commands
    start: 'üëã <b>Cze≈õƒá! Jestem icoffio Bot</b>\n\n' +
           'Pomogƒô Ci tworzyƒá artyku≈Çy:\n\n' +
           'üìù <b>Wy≈õlij tekst</b> ‚Üí Stworzƒô artyku≈Ç z AI\n' +
           'üîó <b>Wy≈õlij URL</b> ‚Üí Spparsujƒô i opublikujƒô\n\n' +
           'üìã <b>Komendy:</b>\n' +
           '/help - Pomoc\n' +
           '/compose - Tryb komponowania\n' +
           '/delete - Usu≈Ñ artyku≈Ç\n' +
           '/queue - Status kolejki\n' +
           '/status - M√≥j status\n' +
           '/language - Wyb√≥r jƒôzyka\n\n' +
           'Powered by GPT-4o ü§ñ',
    help: 'üìñ <b>Jak u≈ºywaƒá bota:</b>',
    helpDetails: '<b>1. Tworzenie artyku≈Çu z tekstu</b>\n' +
                 'Po prostu wy≈õlij tekst (1-2 zdania lub pe≈Çny tekst).\n' +
                 'AI stworzy profesjonalny artyku≈Ç.\n\n' +
                 '<b>2. Tryb komponowania (dla d≈Çugich artyku≈Ç√≥w)</b>\n' +
                 '/compose - Rozpocznij komponowanie\n' +
                 'Wysy≈Çaj kilka wiadomo≈õci po kolei\n' +
                 '/publish - Opublikuj wszystko razem\n' +
                 '/cancel - Anuluj komponowanie\n\n' +
                 '<b>3. Parsowanie artyku≈Çu z URL</b>\n' +
                 'Wy≈õlij link do artyku≈Çu.\n' +
                 'Bot sparsuje i doda do systemu.\n\n' +
                 '<b>4. Usuwanie artyku≈Çu</b>\n' +
                 '/delete - Wy≈õlij link do artyku≈Çu do usuniƒôcia\n\n' +
                 '<b>Komendy:</b>\n' +
                 '/start - PoczƒÖtek pracy\n' +
                 '/compose - Tryb komponowania\n' +
                 '/publish - Opublikuj skomponowane\n' +
                 '/cancel - Anuluj\n' +
                 '/delete - Usu≈Ñ artyku≈Ç\n' +
                 '/queue - Zobacz kolejkƒô\n' +
                 '/status - Status systemu\n' +
                 '/language - Wyb√≥r jƒôzyka',
    queue: 'üìä <b>Status kolejki:</b>',
    status: '‚úÖ <b>System aktywny</b>',
    language: 'üåç <b>Wyb√≥r jƒôzyka interfejsu</b>',
    languagePrompt: 'Wybierz jƒôzyk:\n' +
                    'üá∑üá∫ –†—É—Å—Å–∫–∏–π - /lang_ru\n' +
                    'üáµüá± Polski - /lang_pl\n' +
                    'üá¨üáß English - /lang_en',
    languageChanged: '‚úÖ Jƒôzyk zmieniony na Polski',
    unknownCommand: '‚ùì Nieznana komenda',

    // Compose mode
    compose: 'üìù <b>Tryb komponowania aktywowany</b>',
    composeStarted: '‚úçÔ∏è Teraz wysy≈Çaj wiadomo≈õci jednƒÖ po drugiej.\n' +
                    'Po≈ÇƒÖczƒô je w jeden artyku≈Ç.\n\n' +
                    'üìã <b>Komendy:</b>\n' +
                    '/publish - Opublikuj wszystko\n' +
                    '/cancel - Anuluj',
    composeInfo: 'üìä <b>Zgromadzono:</b>',
    publish: '‚úÖ <b>Publikujƒô skomponowany artyku≈Ç...</b>',
    cancel: '‚ùå <b>Anulowano</b>',
    composeCancelled: 'Tryb komponowania anulowany. Wszystkie wiadomo≈õci usuniƒôte.',
    notInComposeMode: '‚ö†Ô∏è Nie jeste≈õ w trybie komponowania.\n\nU≈ºyj /compose aby rozpoczƒÖƒá.',
    composeEmpty: '‚ö†Ô∏è Brak zgromadzonych wiadomo≈õci.\n\nWy≈õlij tekst po komendzie /compose',
    composeStats: 'Wiadomo≈õci: {count}\nZnak√≥w: {length}\nCzas: {duration} sek',

    // Delete command
    deleteCommand: 'üóëÔ∏è <b>Usuwanie artyku≈Çu</b>',
    deletePrompt: 'Wy≈õlij link do artyku≈Çu do usuniƒôcia:\n\n' +
                  'Na przyk≈Çad:\n' +
                  'https://app.icoffio.com/en/article/my-article-en\n' +
                  'https://app.icoffio.com/pl/article/my-article-pl',
    deleteSuccess: '‚úÖ <b>Artyku≈Ç usuniƒôty!</b>\n\n' +
                   'üìù Slug: {slug}\n' +
                   'üåç Jƒôzyk: {lang}',
    deleteError: '‚ùå <b>B≈ÇƒÖd usuwania</b>\n\n{error}',
    invalidArticleUrl: '‚ùå <b>Nieprawid≈Çowy link</b>\n\n' +
                       'Link powinien byƒá w formacie:\n' +
                       'https://app.icoffio.com/[jƒôzyk]/article/[slug]',

    // Inline buttons
    btnAddMore: 'üìù Dodaj wiƒôcej',
    btnPublishNow: '‚úÖ Opublikuj teraz',

    // Processing
    textReceived: '‚ú® <b>Tekst otrzymany!</b>',
    urlReceived: 'üîÑ <b>URL otrzymany!</b>',
    addedToQueue: 'üìã Dodano do kolejki:',
    aiGenerating: 'ü§ñ AI generuje artyku≈Ç...',
    pleaseWait: '‚è≥ Proszƒô czekaƒá (~60 sekund)',

    // Success
    published: '‚úÖ <b>OPUBLIKOWANO!</b>',
    title: 'üìù <b>Tytu≈Ç:</b>',
    words: 'üí¨ <b>S≈Çowa:</b>',
    languages: 'üåç <b>Jƒôzyki:</b>',
    time: '‚è±Ô∏è <b>Czas:</b>',
    statusPublished: '‚ú® <b>Status:</b> Opublikowano na stronie!',
    category: 'üìÅ <b>Kategoria:</b>',

    // Errors
    error: '‚ùå <b>B≈ÇƒÖd</b>',
    jobNotFound: 'Zadanie nie znalezione. Spr√≥buj ponownie.',
    createdNotPublished: '‚úÖ <b>Utworzono (nie opublikowano)</b>',
    checkSettings: 'Sprawd≈∫ ustawienia WordPress.',
    errorAiGeneration: '‚ùå <b>B≈ÇƒÖd generacji AI</b>\n\nNie uda≈Ço siƒô utworzyƒá tre≈õci artyku≈Çu.',
    errorUrlParsing: '‚ùå <b>B≈ÇƒÖd parsowania URL</b>\n\nNie uda≈Ço siƒô pobraƒá tre≈õci z linku.',
    errorPublication: '‚ùå <b>B≈ÇƒÖd publikacji</b>\n\nArtyku≈Ç utworzony, ale nie opublikowany.',
    errorProcessing: '‚ùå <b>B≈ÇƒÖd przetwarzania</b>',
    timeout: '‚è±Ô∏è <b>Timeout</b>\n\nPrzetwarzanie trwa zbyt d≈Çugo.',
    checkLater: 'Sprawd≈∫ status p√≥≈∫niej komendƒÖ /queue',

    // Queue status
    queueStatus: 'üìä <b>Status kolejki:</b>',
    totalJobs: 'üìã Wszystkie zadania:',
    pending: '‚è≥ OczekujƒÖce:',
    processing: '‚öôÔ∏è Przetwarzane:',
    completed: '‚úÖ Zako≈Ñczone:',
    errors: '‚ùå B≈Çƒôdy:',
    systemWorking: 'üîÑ System pracuje',
    systemWaiting: 'üí§ System oczekuje',

    // System status
    systemActive: '‚úÖ <b>System aktywny</b>',
    aiModel: 'ü§ñ AI: GPT-4o',
    images: 'üé® Obrazy: DALL-E 3 + Unsplash',
    languagesSupported: 'üåç Jƒôzyki: RU, EN, PL',
    queueActive: 'üìä Queue: Aktywna',
    allSystemsNormal: 'Wszystkie systemy dzia≈ÇajƒÖ normalnie!'
  },

  en: {
    // Commands
    start: 'üëã <b>Hello! I\'m icoffio Bot</b>\n\n' +
           'I\'ll help you create articles:\n\n' +
           'üìù <b>Send text</b> ‚Üí I\'ll create an article with AI\n' +
           'üîó <b>Send URL</b> ‚Üí I\'ll parse and publish\n\n' +
           'üìã <b>Commands:</b>\n' +
           '/help - Help\n' +
           '/compose - Compose mode\n' +
           '/delete - Delete article\n' +
           '/queue - Queue status\n' +
           '/status - My status\n' +
           '/language - Language selection\n\n' +
           'Powered by GPT-4o ü§ñ',
    help: 'üìñ <b>How to use the bot:</b>',
    helpDetails: '<b>1. Create article from text</b>\n' +
                 'Just send text (1-2 sentences or full text).\n' +
                 'AI will create a professional article.\n\n' +
                 '<b>2. Compose mode (for long articles)</b>\n' +
                 '/compose - Start composing\n' +
                 'Send multiple messages in a row\n' +
                 '/publish - Publish everything together\n' +
                 '/cancel - Cancel composing\n\n' +
                 '<b>3. Parse article from URL</b>\n' +
                 'Send a link to an article.\n' +
                 'Bot will parse and add to the system.\n\n' +
                 '<b>4. Delete article</b>\n' +
                 '/delete - Send article link to delete\n\n' +
                 '<b>Commands:</b>\n' +
                 '/start - Start working\n' +
                 '/compose - Compose mode\n' +
                 '/publish - Publish composed\n' +
                 '/cancel - Cancel\n' +
                 '/delete - Delete article\n' +
                 '/queue - View queue\n' +
                 '/status - System status\n' +
                 '/language - Language selection',
    queue: 'üìä <b>Queue status:</b>',
    status: '‚úÖ <b>System active</b>',
    language: 'üåç <b>Interface language selection</b>',
    languagePrompt: 'Choose language:\n' +
                    'üá∑üá∫ –†—É—Å—Å–∫–∏–π - /lang_ru\n' +
                    'üáµüá± Polski - /lang_pl\n' +
                    'üá¨üáß English - /lang_en',
    languageChanged: '‚úÖ Language changed to English',
    unknownCommand: '‚ùì Unknown command',

    // Compose mode
    compose: 'üìù <b>Compose mode activated</b>',
    composeStarted: '‚úçÔ∏è Now send messages one after another.\n' +
                    'I\'ll combine them into one article.\n\n' +
                    'üìã <b>Commands:</b>\n' +
                    '/publish - Publish everything\n' +
                    '/cancel - Cancel',
    composeInfo: 'üìä <b>Accumulated:</b>',
    publish: '‚úÖ <b>Publishing composed article...</b>',
    cancel: '‚ùå <b>Cancelled</b>',
    composeCancelled: 'Compose mode cancelled. All messages deleted.',
    notInComposeMode: '‚ö†Ô∏è You are not in compose mode.\n\nUse /compose to start.',
    composeEmpty: '‚ö†Ô∏è No accumulated messages.\n\nSend text after /compose command',
    composeStats: 'Messages: {count}\nCharacters: {length}\nTime: {duration} sec',

    // Delete command
    deleteCommand: 'üóëÔ∏è <b>Delete article</b>',
    deletePrompt: 'Send article link to delete:\n\n' +
                  'For example:\n' +
                  'https://app.icoffio.com/en/article/my-article-en\n' +
                  'https://app.icoffio.com/pl/article/my-article-pl',
    deleteSuccess: '‚úÖ <b>Article deleted!</b>\n\n' +
                   'üìù Slug: {slug}\n' +
                   'üåç Language: {lang}',
    deleteError: '‚ùå <b>Deletion error</b>\n\n{error}',
    invalidArticleUrl: '‚ùå <b>Invalid link</b>\n\n' +
                       'Link should be in format:\n' +
                       'https://app.icoffio.com/[language]/article/[slug]',

    // Inline buttons
    btnAddMore: 'üìù Add more',
    btnPublishNow: '‚úÖ Publish now',

    // Processing
    textReceived: '‚ú® <b>Text received!</b>',
    urlReceived: 'üîÑ <b>URL received!</b>',
    addedToQueue: 'üìã Added to queue:',
    aiGenerating: 'ü§ñ AI generating article...',
    pleaseWait: '‚è≥ Please wait (~60 seconds)',

    // Success
    published: '‚úÖ <b>PUBLISHED!</b>',
    title: 'üìù <b>Title:</b>',
    words: 'üí¨ <b>Words:</b>',
    languages: 'üåç <b>Languages:</b>',
    time: '‚è±Ô∏è <b>Time:</b>',
    statusPublished: '‚ú® <b>Status:</b> Published on the site!',
    category: 'üìÅ <b>Category:</b>',

    // Errors
    error: '‚ùå <b>Error</b>',
    jobNotFound: 'Job not found. Try again.',
    createdNotPublished: '‚úÖ <b>Created (not published)</b>',
    checkSettings: 'Check WordPress settings.',
    errorAiGeneration: '‚ùå <b>AI generation error</b>\n\nFailed to create article content.',
    errorUrlParsing: '‚ùå <b>URL parsing error</b>\n\nFailed to get content from the link.',
    errorPublication: '‚ùå <b>Publication error</b>\n\nArticle created but not published.',
    errorProcessing: '‚ùå <b>Processing error</b>',
    timeout: '‚è±Ô∏è <b>Timeout</b>\n\nProcessing is taking too long.',
    checkLater: 'Check status later with /queue command',

    // Queue status
    queueStatus: 'üìä <b>Queue status:</b>',
    totalJobs: 'üìã Total jobs:',
    pending: '‚è≥ Pending:',
    processing: '‚öôÔ∏è Processing:',
    completed: '‚úÖ Completed:',
    errors: '‚ùå Errors:',
    systemWorking: 'üîÑ System working',
    systemWaiting: 'üí§ System waiting',

    // System status
    systemActive: '‚úÖ <b>System active</b>',
    aiModel: 'ü§ñ AI: GPT-4o',
    images: 'üé® Images: DALL-E 3 + Unsplash',
    languagesSupported: 'üåç Languages: RU, EN, PL',
    queueActive: 'üìä Queue: Active',
    allSystemsNormal: 'All systems operating normally!'
  }
};

/**
 * Get translated message
 */
export function t(chatId: number, key: keyof typeof translations['ru']): string {
  const lang = getUserLanguage(chatId);
  return translations[lang][key];
}

